import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.regex.Pattern;

/**
 * Created by giuseppeliguori on 23/12/2017.
 */
public class Nineteen {
    String input = " |                                                                                                                                                                                                       \n" +
            " |                                   +---------------------------------------------------------------------------------------------------------------------------------------------------------------+   \n" +
            " |                                   |                                                                                                                                                               |   \n" +
            " |     +-------------------------------------------+                                                   +-------------+   +---------------+                     +-------------------------------------+   \n" +
            " |     |                             |             |                                                   |             |   |               |                     |                                         \n" +
            " |     +-----------------------------|---------+   |   +-+ +-------+                       +---+       |             |   |   +-----------|-----------------------------------------+   +-----------+     \n" +
            " |                                   |         |   |   | | |       |                       |   |       |             |   |   |           |                     |                   |   |           |     \n" +
            " |                                   |         +---|---|---|-------------------------------|---|-------|-------------|---|---------------|---------------------------------------------+           |     \n" +
            " |                                   |             |   | | |       |                       |   |       |             |   |   |           |                     |                   |               |     \n" +
            " |       +-----------------+         |         +---------|--------------------------B----------+       +-------------|---|---|-----------|---------------------|---------------+   | +---+     +-+ |     \n" +
            " |       |                 |         |         |   |   | | |       |                       |                         |   |   |           |                     |               |   | |   |     | | |     \n" +
            " |       |                 |         |         |   |   +-|---------|-------+               |           +---------------------------------------+               |               |   +-|---|-------+ |     \n" +
            " |       |                 |         |         |   |     | |       |       |               |           |             |   |   |           |     |               |               |     |   |     |   |     \n" +
            " |       |                 |         |         +---------|-|---------------|---------+     |     +-----|-------+     |   |   |           |     |               |               |     |   |     |   |     \n" +
            " |       |                 |         |             |     | |       |       |         |     |     |     |       |     |   |   |           |     |               |               |     |   |     |   |     \n" +
            " |       |                 +---------|-------------|-----|-|-------+       |         +-----|-----|-------------------+   | +-------------------+               |   +---------------------|-----|-------+ \n" +
            " |       |                           |             |     | |               |               |     |     |       |         | | |           |                     |   |           |     |   |     |   |   | \n" +
            " |       +---------------------------------------+ |   +-|-+               |               |     |     |     +-+ +-------|-|-|-+         |                     |   |           |     |   |     | +-+   | \n" +
            " |                                   |           | |   | |                 |               |     |     |     |   |       | | | |         |                     |   |           |     |   |     | |     | \n" +
            " |                                   |         +-|-----|-|-+               |     +---------|-----|-----------|---|---+ +-|-|-----+     +-|-+                   +---------+     +-------+ |     | |     | \n" +
            " |                                   |         | | |   | | |               |     |         |     |     |     |   |   | | | | | | |     | | |                       |     |           | | |     | |     | \n" +
            " |                                   |         | | |   | | |           +---|-----|---------|-----|-----|---------|---|-|-|-|---|-|-----|-|-|-----------------------------|-------+   | | | +---+ |     | \n" +
            " |                                   |         | | |   | | |           |   |     |         |     |     |     |   |   | | | | | | |     | | |                       |     |       |   | | | |     |     | \n" +
            " | +---------------------------------|---------|---|---|-|-------------|-------------------|-----------+     +---------|-|-+ | | +-+   | | +-------------+         |     |       |   | | | |     |     | \n" +
            " | |                                 |         | | |   | | |           |   |     |         |     |               |   | | |   | |   |   | |               |         |     |       |   | | | |     |     | \n" +
            " | | +-+ +-+                         |         | | |   | | |         +-----------|-----+   |     |   +-----------|---+ | |   | +---|-+ | |               |         |     |       |   | | | |     |     | \n" +
            " | | | | | |                         |         | | |   | | |         | |   |     |     |   |     |   |           |     | |   |     | | | |               |         |     |       |   | | | |     |     | \n" +
            " | | | | | +-------------------------|---------|-|-----|---|---------------|-----|---------|-----|---------------|-------|-------------|---+             |         |     |   +---|---|-|-|-------|-+   | \n" +
            " | | | | |                           |         | | |   | | |         | |   |     |     |   |     |   |           |     | |   |     | | | | |             |         |     |   |   |   | | | |     | |   | \n" +
            " | | | +---+         +-------------------------------+ +-|-+         | |   |     |     |   |     |   |           |     | |   +-----+ | | | |             |         |     |   |   |   | | | |     | |   | \n" +
            " | | |   | |         |               |         | | | |   |           | |   |     |     |   |     |   |           |     | |           | | | |             |         |     |   |   |   | | | |     | |   | \n" +
            " | | |   | |         |               |     +---|---|-----------------|-----------|-------------------|-----------------|-------------|-----------------------------|-----------------|---|-|-+   | |   | \n" +
            " | | |   | |         |               |     |   | | | |   |           | |   |     |     |   |     |   |           |     | |           | | | |             |         |     |   |   |   | | | | |   | |   | \n" +
            " | | |   | |       +-+ +-------------|---------|-|---|-------+       | |   |     |     |   |   +-----|-----------------------------------|-|-+   +-------|---------|-----|---|---------+ | +-----+ |   | \n" +
            " | | |   | |       |   |             |     |   | | | |   |   |       | |   |     |     |   |   | |   |           |     | |           | | | | |   |       |         |     |   |   |   |   |   |     |   | \n" +
            " | | |   | |       |   |             |     |   | | | |   |   |       | |   |     |     +---------|---|-----+     |     +-|-------------|-----+   |       |         |     |   |   |   |   |   |     |   | \n" +
            " | | |   | |       |   |             |     |   | | | |   |   |       | |   |     |         |   | |   |     |     |       |           | | | |     |       |         |     |   |   |   |   |   |     |   | \n" +
            " +---------------------------------------------|---|-|-+ |   |       | |   |     |     +-------------+     |     |       |     +-----|-|-|-------|-------|---------------|---|-------------+ |     |   | \n" +
            "   | |   | |       |   |             |     |   | | | | | |   |       | |   |     |     |   |   | |         |     |       |     |     | | | |     |       |         |     |   |   |   |   | | |     |   | \n" +
            "   | |   | | +---------------+     +-------|---|-|-+ | | |   |     +---|---|-----|-----|---|---|-------------------------------|---------|-|-----|-+     |         |     |   |   |   |   | | |     |   | \n" +
            "   | |   | | |     |   |     |     | |     |   | |   | | |   |     | | |   |     |     |   |   | |         |     |       |     |     | | | |     | |     |         |     |   |   |   |   | | |     |   | \n" +
            "   | |   | | |     |   |     |   +-|-------|-----|-----------|-------|-|---|-------------------|-|---------|-----|-------|-----------|-|-|-|-----------------------|-----|---+   |   |   | | | +-----+ | \n" +
            "   | |   | | |     |   |     |   | | |     |   | |   | | |   |     | | |   |     |     |   |   | |         |     |       |     |     | | | |     | |     |         |     |       |   |   | | | |   | | | \n" +
            "   | |   | | |     |   |     |   | | |     |   | |   | | |   |     | | |   |     |   +-+   |   +-|---+     |     | +-------+   |     | | | |     | |     |         |     |       |   |   | | | |   +---+ \n" +
            "   | |   | | |     |   |     |   | | |     |   | |   | | |   |     | | |   |     |   |     |     |   |     |     | |     | |   |     | | | |     | |     |         |     |       |   |   | | | |     |   \n" +
            "   | |   | +-|---------------------|-------|-+ | |   | | | +-------|-|-------------------------+ |   +-----|---------------------+ +---+ +-------|-----+ |   +-----|-------------|---------|-|---+ +---+ \n" +
            "   | |   |   |     |   |     |   | | |     | | | |   | | | | |     | | |   |     |   |     |   | |         |     | |     | |   | | | |     |     | |   | |   |     |     |       |   |   | | | | | | | | \n" +
            "   | |   |   |     |   |     |   | | |     | | | |   +-|-----|-------|-----+     |   |     |   | +---------------|-|-----------|---+ +-----|-----+ +---|-------------------------|---|---|-|-|-|---+ | | \n" +
            "   | |   |   |     |   |     |   | | |     | | | |     | | | |     | | |         |   |     |   |           |     | |     | |   | |         |           | |   |     |     |       |   |   | | | | |   | | \n" +
            "   | |   |   |     |   |     |   | | |     | | | |     | | | |     +-----------------|-----|---|-----------|-------|-----|---+ | +-+       |           | |   |     |     |       |   |   | | | | | +-|-+ \n" +
            "   | |   |   |     |   |     |   | | |     | | | |     | | | |       | |         |   |     |   |           |     | |     | | | |   |       |           | |   |     |     |       |   |   | | | | | | |   \n" +
            "   | |   |   |     |   |     |   | | |     | | +---+   | | | |     +---------------------------------------|-----|-|-------|---|-----------------------|-|---|-------------------|-----------|-+ | +---+ \n" +
            "   | |   |   |     |   |     |   | | |     | |   | |   | | | |     | | |         |   |     |   |           |     | |     | | | |   |       |           | |   |     |     |       |   |   | | |   |   | | \n" +
            "   | |   |   |     +-+ |     |   | | |     | |   | | +---|-|-+     | | |     +-------|---------|-----------------|-------------|-----------|-----------|-----------|-----|-----------|-+ | | |   |   | | \n" +
            "   | |   |   |       | |     |   | | |     | |   | | | | | |       | | |     |   |   |     |   |           |     | |     | | | |   |       |           | |   |     |     |       |   | | | | |   |   | | \n" +
            "   | |   |   | +-------|---------|---|-----|-----|-|-|---|-----------|-------|-------------+   |     +-----|-------|-+   | | | |   |       |           | |   |     |     |   +---|---|-|-|-|-|---------+ \n" +
            "   | |   |   | |     | |     |   | | |     | |   | | | | | |       | | |     |   |   |         |     |     |     | | |   | | | |   |       |           | |   |     |     |   |   |   | | | | |   |   |   \n" +
            "   | |   |   | |     | |     |   +---------|-|-----|---------------|-|-------|---|-------------------------|-----|-|-|---|---|-------------|-------------|-----+   |     |   |   |   | | | | |   |   |   \n" +
            "   | |   |   | |     | |     |     | |     | |   | | | | | |       | | |     |   |   |         |     |     |     | | |   | | | |   |       |           | |   | |   |     |   |   |   | | | | |   |   |   \n" +
            "   | |   |   | +-------------|-----|-|-----+ |   | | | | | |       | | |     |   |   |         |     |     |     | | +-----|-|-|---+       |           | |   | |   |     +---|---|---|-----+ | +-+   |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |   |         |     |     |     | |     | | | |           |           | |   | |   |         |   |   | | |   | |     |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |   |         |     |     |     | | +-------|-|-----------|-------------|---|-|-----------------------|---+ | |     |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |   |         |     |     |     | | |   | | | |           |           | |   | |   |         |   |   | | | | | |     |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |   |     +---|-----|-----|-----|-|-----|---|-------------|-----------|-|---|-|-------------|-+ |   | | | | | |     |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |   |     |   |     |     |     | | |   | | | |           |           | |   | |   |         | | |   | | | | | |     |   \n" +
            "   | |   |   | +-----|-------------------------------|---|-|-----------------|---|---|---------|-----|-----|-----|-|-|-----|-|-|-------------+         | |   | |   |       +-|-|-|---|---|-|-------+ |   \n" +
            "   | |   |   | |     | |     |     | |       |   | | | | | |       | | |     |   |   |     |   |     |     |     | | |   | | | |           | |         | |   | |   |       | | | |   | | | | | |   | |   \n" +
            "   | |   |   | |     | |     |     | |       |   | | | | | |       | | |     |   | +-|---------------|-----|---------|-----|-|-|-------------|---------|U|---------------+ | | | |   | | | | | |   | |   \n" +
            "   | |   |   | |     | |     |     | |       |   | | | | | |       | | |     |   | | |     |   |     |     |     | | |   | | | |           | |         | |   | |   |     | | | | |   | | | | | |   | |   \n" +
            "   | |   |   | |     | |     |     | |       |   | | | | | |       | | |     |   | +-+     |   |     |     |     | | |   +-|---|-------------|-+       | | +---|---------|-|-----|-+ | | | | | |   | |   \n" +
            "   | |   |   | |     | |     |     | |       |   | | | | | |       | | |     |   |         |   |     |     |     | | |     | | |           | | |       | | | | |   |     | | | | | | | | | | | |   | |   \n" +
            "   | |   |   | +-----|-------|-----|-------------|---|---|-|-----------|-----------------------|-----|---------------------|-|-------------|-----------|-|-+ | |   |     | | | | | | | | | +-----+ | |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |         |   |     |     |     | | |     | | |           | | |       | |   | |   |     | | | | | | | | |   | | | | |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |         |   |     |   +-|-----|---------|-|---------------|-|---------------|---|-----+ | | | | | | | |   | | | | |   \n" +
            "   | |   |   |       | |     |     | |       |   | | | | | |       | | |     |   |         |   |     |   | |     | | |     | | |           | | |       | |   | |   |       | | | | | | | |   | | | | |   \n" +
            "   | | +---------+   | |     |     | | +-----|-------+ | | |       | +-----------------------------------|-|---------------+ | |       +---|-|-+     +-+ |   | |   +-------|-|-|-|---|-|-|-+ | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |         |   |     |   | |     | | |       | |       |   | |       |   |   | |           | | | | | | | | | | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |         |   |     |   | |     | | |       | |       |   | | +-----+   |   | |     +---+ | | | | | | | | | | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |         |   |     |   | |     | | |       | |       |   | | |         |   | |     |   | | | | | | | | | | | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |         |   |     |   | |     | | |       | |       |   | | |         |   | |     |   | | | | | | | | | | | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |         |   |     |   | |     | | |       | |       |   | | |         |   | |     |   | | | | | | | | | | | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |         +-------+ |   | |     | | |     +-|-|-------|-----|-|---------|-----------|-+ | | | | | | | | | | | | | | |   \n" +
            "   | | | |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |             |   | |   | |     | | |     | | |       |   | | |         |   | |     | | | | | | | | | | | | | | | | |   \n" +
            "   | | +-----|---|---|-|-----|-----|-----------------------------------|-----|-----------------|---------|-------|---------|-----+   +-------+ |         |   | |     | | | | | | | | | | | | | | | | |   \n" +
            "   | |   |   |   |   | |     |     | | |     |   | |   | | |       |   |     |   |             |   | |   | |     | | |     | | | |   | |   |   |         |   | |     | | | | | | | | | | | | | | | | |   \n" +
            "   | |   |   |   |   | +-------------|-|-----|-----|---|-|-|---+   |   |   +-|-----------------------|---|-|---------|-----|---|-|---|---------|-------------|---------|-+ | | +-----|-----|---|---|---+ \n" +
            "   | |   |   |   |   |       |     | | |     |   | |   | | |   |   |   |   | |   |             |   | |   | |     | | |     | | | |   | |   |   |         |   | |     | |   | |   | | | | | | | | | | | | \n" +
            " +-|-----|-------|---------------------|-----|---|-|---|-------|-----------|-|---------------------|-|-----|-----|-|-|-----|-|-|-----|-----|---|-------+ |   | +-----|-|-----|---|---|---|-|---|---+ | | \n" +
            " | | |   |   |   |   |       |     | O |     |   | |   | | |   |   |   |   | |   |             |   | |   | |     | | |     | | | |   | |   |   |       | |   |       | |   | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |     |   | |   | | |   |   |   |   | |   |             |   | |   | |     | | |     | | | +---|-----|-S |       | |   |       | +-+ | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |     |   | |   | | |   |   |   |   | |   |             |   | |   | |     | | |     | | |     | |   |   |       | |   |       |   | | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |     |   | |   | | |   |   |   |   | |   |             +---|-|---|-|---------------|-|-|-------|---+ +-|-------|-----|-------|---+ | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |     |   | |   | | |   |   |   |   | |   |                 | |   | |     | | |     | | |     | |     | |       | |   |       |     | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |   +-------|---|---|-------|-------|-----------------------|-|-------------------------|---------+   | |       | |   |       | +-+ | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |   | |   | |   | | |   |   |   |   | |   |                 | |   | |     | | |     | | |     | | |   | |       | |   |       | | | | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |   | |   | |   | | |   |   |   |   | |   |                 | |   | |     | | |     | | |     | | |   | |       | |   |       | | | | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |   | |   | |   | | |   |   |   |   | |   |                 | |   | |     | | |     | | |     | | |   | |       | |   |       | | | | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |   | +-----|-------|-------|-----+ | |   |               +-|-|-----|-----|---|---+ | | |     | | |   | |       | |   |       | | | | |   | | | | | | | | |   | | \n" +
            " | | |   |   |   |   |       |     | | |   |     | |   | | |   |   |   | | | |   |               | | |   | |     | | |   | | | |     | | |   | |       | |   |       | | | | |   | | | | | | | | |   | | \n" +
            " | | | +-|---|---|-----------|-------|-----|-----|-|---------------|-----|-|-|-------------------|-|-|---------+ | | |   | | | |     | | |   | +-------------|-+     | | | | |   | +---+ | | | | |   | | \n" +
            " | | | | |   |   |   |       |     | | |   |     | |   | | |   |   |   | | | |   |               | | |   | |   | | | |   | | | |     | | |   |         | |   | |     | | | | |   |   |   | | | | |   | | \n" +
            " | | | | |   |   |   |       |     | | |   |     | |   | | |   |   |   | | | |   |               | | |   | |   | | | |   | | | |     | | |   |         | |   | |     +---|---|-+ |   |   | | | | |   | | \n" +
            " | | | | |   |   |   |       |     | | |   |     | |   | | |   |   |   | | | |   |               | | |   | |   | | | |   | | | |     | | |   |         | |   | |       | | | | | |   |   | | | | |   | | \n" +
            " | | | | |   |   |   |       |     | | |   |     | |   | | |   |   |   | | | |   |               | | |   | |   | | | |   | | +-----------|-+ |         | |   | |     +---|---+ | |   |   | | | | |   | | \n" +
            " | | | | |   |   |   |       |     | | |   |     | |   | | |   |   |   | | | |   |               | | |   | |   | | | |   | |   |     | | | | |         | |   | |     | | | |   | |   |   | | | | |   | | \n" +
            " | | | | |   |   | +-|---------------|-|-----------|-----|-----|---|-----|-------|-------------+ | +-------|-+ | | | |   | |   |     | | | | | +---------|---|-----------|-----|---------|---|-------|-+ \n" +
            " | | | | |   |   | | |       |     | | |   |     | |   | | |   |   |   | | | |   |             | |   |   | | | | | | |   | |   |     | | | | | |       | |   | |     | | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |   | | |       |     | | |   |     | |   | | |   |   |   | | | |   |             | |   |   | | | | | | |   | |   |     | | | | | |       | |   | |     | | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |   | | |       |     | | |   |     | |   | | |   |   |   | | | |   |             | |   |   | | | | | | |   | |   |     | | | | | |       | |   | |     | | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |   | | |       |     | | |   |     | |   | | |   |   |   | | | |   |             | |   |   | | | | | | |   | |   |     | | | +-|-|-+     | |   | |     | | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |   | | |       |     | | |   |     | |   | | |   |   |   | | | |   |             | |   |   | | | | | | |   | |   |     | | |   | | |     | |   | |     | | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |   +-|-|-------|-----|---|---------|-|-----------+   |   | | | |   |             | |   +---|---|-|-|-|-------|---------|---|---|-+ +-+   | +---|-------+ | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |     | |       |     | | |   |     | |   | | |       |   | | | |   |             | |       | | | | | | |   | |   |     | | |   |     |   |     | |       | | |   | |   |   | | | | |   |   \n" +
            " | | | | |   |     | | +-------------------|-------|-------|-----------|---|-|-----------------|-----------|-------|-----|-+   +-------|-|---|-------------------------|---|-------------|-|---------|-+ \n" +
            " | | | | |   |     | | |     |     | | |   |     | |   | | |       |   | | | |   |             | |       | | | | | | |   |           | | |   |     |   |     | |       | | |   | |   |   | | | | |   | | \n" +
            " | | | | | +---------------------------|---|-----|-----------------|---|-|-|-|---|-------------|-|---------|-+ | | | |   |           | | | +-|-----|-----------|-------|---|-----|---|-+ | | | | |   | | \n" +
            " | | | | | | |     | | |     |     | | |   |     | |   | | |       |   | | | |   |             | |       | |   | | | |   |           | | | | |     |   |     | |       | | |   | |   | | | | | | |   | | \n" +
            " | | +---|---------------------------|-------------|-------------------|-|-|-|---------+ +-----|-----------|-----|-|-|---|-------------|-|-------+ |   |     | |       | | |   | +-----------+ | |   | | \n" +
            " | |   | | | |     | | |     |     | | |   |     | |   | | |       |   | | | |   |     | |     | |       | |   | | | |   |           | | | | |   | |   |     | |       | | |   |     | | | |   | |   | | \n" +
            " | |   | | | |     | | +-----|-----|---|---|---+ | |   | | |   +-------|-----|-----------|---------------|-------|---|-------------------|-+ |   | |   |     | |       | | | +-|-----|---|-|---|-|-+ | | \n" +
            " | |   | | | |     | |       |     | | |   |   | | |   | | |   |   |   | | | |   |     | |     | |       | |   | | | |   |           | | |   |   | |   |     | |       | | | | |     | | | |   | | | | | \n" +
            " | |   | | +-+     | |       |     | | |   |   | | |   | | |   |   |   | | | |   |     | |     | |       +-------|-|-|---|-----------|---|---|---|-----|-----|-|---------|-----------|-|-|-|-+ | | | | | \n" +
            " | |   | |         | |       |     | | |   |   | | |   | | |   |   |   | | | |   |     | |     | |         |   | | | |   |           | | |   |   | |   |     | |       | | | | |     | | | | | | | | | | \n" +
            " | | +---|---------|---+     |     | | |   |   | | |   | | |   | +-----|-|-+ |   |     | |     | |         |   | | | |   |           | | |   |   | |   |     | |       | | | | |     | | | | | | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |   | |   |   |     | |     | |         |   | | | |   |           | | |   |   | |   |     | |       | | | | |     | | | | | | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |   +---------|-----|-|-----------------|-------|-------------------|-|---|---|-|---|-------+       | | | | |     +-|---|-+ | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |     |   |   |     | |     | |         |   | | | |   |           | | |   |   | |   |     |         | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |     |   |   | +-----|-----------------|---|-|---|---|---------+ | | |   |   | |   |     |         | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |     |   |   | |   | |     | |         |   | | | |   |         | | | |   |   | |   |     |         | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |     +-------+ |   | |     | |         |   | | | |   |       +-|-|-------+ +-------------|---+     | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |         |     |   | |     | |         |   | | | |   |       | | | | |     | | |   |     |   |     | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |         |     |   | |     | |         |   | | | |   |       | | | +-------+ | |   |     |   |     | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | | |         |     |   | |     | |         |   | | | |   |       | | |   |       | |   |     |   |     | C | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   | +---------------------|-|-----|-|-----------------|-----|-------------+ |       | |   |     |   |     | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   |   |         |     |   | |     | |         |   | | | |   |       | | | | |       | |   |     |   |     | | | | |       | | |   | | | | | \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   |   |         |     |   | |     | |         |   | | | |   |       | | | | |       | |   |     |   |     | | | | |       | | | +-|-----|-+ \n" +
            " | | | | |         | | |     |     | | |   |   | | |   | | |   |   |         |     |   | |     | |         |   | | | |   |       | | | | |       | |   |     |   |     | | | | |       | | | | | | | |   \n" +
            " | | | | |         | | |     |     | | |   |   | +-----|-+ |   +-------------|-----------|-----------------+   | +-|-|---|-----------+ | |       | |   |     |   |     | | | | |       | | | | | | | |   \n" +
            " | | | | |         | | |     |     | | |   |   |   |   |   |       |         |     |   | |     | |             |   | |   |       | |   | |       | |   |     |   |     | | | | |       | | | | | | | |   \n" +
            " | | | | |         | | |     |     | | |   |   |   +---|---|-------|---------------|---+ |     | |             |   | |   |       | |   | |       | |   |     |   |     | | | | |       | | | | | | | |   \n" +
            " | | | | |         | | |     |     | | |   |   |       |   |       |         |     |     |     | |             |   | |   |       | |   | |       | |   |     |   |     | | | | |       | | | | | | | |   \n" +
            " | | | | |         | | |     |     +-|-|---|---|-------|---|-------|-----+   |     |     +---+ | |         +---|---------|---------------------+ | |   |     |   |     | | | | | +-------|-|---|-|-|-|-+ \n" +
            " | | | | |         | | |     |       | |   |   |       |   |       |     |   |     |         | | |         |   |   | |   |       | |   | |     | | |   |     |   |     | | | | | |     | | | | | | | | | \n" +
            " | | | | |         | | |     |       | |   |   |       |   |       |     |   |     |         | | |         |   |   | |   |       | |   | |     | | |   |     |   |     | | | | | |     | | | | | | | | | \n" +
            " | | | | |         | | |     |       | |   |   |       |   |       |     |   |     |         | | |         |   |   | |   |       | |   | |     | | |   |     |   |     | | | | | |     | | | | | | | | | \n" +
            " | +-+ | |         | | |     |       | |   | +-+       |   |       |     |   |     |         | | +---------|-------|-|-----------|-|-----------|---|---|-----|---|-----+ +---|---------|-------|-----|-+ \n" +
            " |     | |         | | |     |       | |   | |         |   |       |     |   |     |         | |           |   |   | |   |       | |   | |     | | |   |     |   |         | | | |     | | | | | | | |   \n" +
            " |   +-------------|-|-------|-------------|-|-+   +---|---|-------|-----|---------|---+     | |           |   |   | |   |       | |   | |     | | |   |     |   |         | | | |     | | | | | | | |   \n" +
            " |   | | |         | | |     |       | |   | | |   |   |   |       |     |   |     |   |     | |           |   |   | |   |       | |   | |     | | |   |     |   |         | | | |     | | | | | | | |   \n" +
            " |   | | |       +-|---|---------------|-------|-------|-----------------|---|-----+   |     | |     +---------|---------|-------------|-------|---------------+ |     +-+ | | | |     | | | | | | | |   \n" +
            " |   | | |       | | | |     |       | |   | | |   |   |   |       |     |   |         |     | |     |     |   |   | |   |       | |   | |     | | |   |     | | |     | | | | | |     | | | | | | | |   \n" +
            " |   +-|---------|---+ |     |       | |   | | |   |   |   |       |     |   |         |   +---------|---------------------------|-----|---------------|---------------------|-|-|---+ | | +-+ | | | |   \n" +
            " |     | |       | |   |     |       | |   | | |   |   |   |       |     |   |         |   | | |     |     |   |   | |   |       | |   | |     | | |   |     | | |     | | | | | |   | | |     | | | |   \n" +
            " |     | |       | |   |     |       | |   | | |   |   | +-|-------------|-----------------|-|-------------|-+ |   | |   |       | +-----|-------|-----|-----|-|-------|-----|-|-------+ |     | | | |   \n" +
            " |     | |       | |   |     |       | |   | | |   |   | | |       |     |   |         |   | | |     |     | | |   | |   |       |     | |     | | |   |     | | |     | | | | | |   |   |     | | | |   \n" +
            " |     | |       | |   |     |     +-|-----|-|-----|-------------------+ |   |         | +-+ | |     |     | | |   | |   |       +-----+ |     | | |   |     | | |     +---|---|-|---|-+ |     | | | |   \n" +
            " |     | |       | |   |     |     | | |   | | |   |   | | |       |   | |   |         | |   | |     |     | | |   | |   |               |     | | |   |     | | |       | | | | |   | | |     | | | |   \n" +
            " +-----------------|---+     +-----+ | |   | | |   +---|---|-----------|-|---------------|-----|-----|-------------|-|-------------------+     | | |   |     | | |       | | | +-|---|-+ | +-+ | | | |   \n" +
            "       | |       | |                 | |   | | |       | | |       |   | |   |         | |   | |     |     | | |   | |   |                     | | |   |     | | |       | | |   |   |   | | | | | | |   \n" +
            "       | |       | |                 | |   | | |       | | |       |   | |   |         | |   | |     |     | | |   | |   |                     | | |   |     | | |       | | |   |   +-------|-----|---+ \n" +
            "       | |       | |                 | |   | | |       | | |       |   | |   |         | |   | |     |     | | |   | |   |                     | | |   |     | | |       | | |   |       | | | | | | | | \n" +
            "     +-|-------------------------------|-------|---------|-------------|-|---|-----------+   | |     |     | | |   | +---------------------------|---------------|-------|-|---------+ +---|---|-|-|-|-+ \n" +
            "     | | |       | |                 | |   | | |       | | |       |   | |   |         |     | |     |     | | |   |     |                     | | |   |     | | |       | | |   |   | | | | | | | | |   \n" +
            "     | | |   +---|-----------------+ | |   | | |       | | |     +-|---|---------------|-----|-|-----|---------|---------|-+                   | | |   |     | | |       +---|---|---|---|-------------+ \n" +
            "     | | |   |   | |               | | |   | | |       | | |     | |   | |   |         |     | |     |     | | |   |     | |                   | | |   E     | | |         | |   |   | | | | | | | | | | \n" +
            "     | | |   |   | |   +-----+     | | |   | | +-------|-|-|-------------|---|---------|-------|-----|-----|-------|-----+ |                   | | |   |     | | |         | | +-|---|-|-|-|-+ | | | | | \n" +
            "     | | |   |   | |   |     |     | | |   | |         | | |     | |   | |   |         |     | |     |     | | |   |       |                   | | |   |     | | |         | | | |   | | | |   | | | | | \n" +
            "     | | |   | +-|-----|-----|-------|-|-----------------|-|-----------|-----+         | +---|-------|-----|-------|-----+ |                 +---|-------------|-------------|-------|-----------|---+ | \n" +
            "     | | |   | | | |   |     |     | | |   | |         | | |     | |   | |             | |   | |     |     | | |   |     | |                 | | | |   |     | | |         | | | |   | | | |   | | |   | \n" +
            "     | | |   | | | |   |     |     | | |   | |         | | |     | |   | |             | |   | |     |     | | |   |     | |                 | | | |   |     | | |         | | | |   | | | |   | | |   | \n" +
            "     | | |   | | | |   |     |     | | |   | |         | | |     | |   | |             | |   | |     |     | | |   |     | |                 | | | |   |     | | |         | | | |   | | | |   | | |   | \n" +
            "     | | |   +---|-+   |     |     | | |   | |         | | |     | |   +-|-------------|-|-----------+     | | |   |     +-------------------|-+ +---------------|---------|-|-|-|---------|-----+ |   | \n" +
            "     | | |     | |     |     |     | | |   | |         | | |     | |     |             | |   | |           | | |   |       |                 |     |   |     | | |         | | | |   | | | |   |   |   | \n" +
            "     | | |     | |     |     |     | | |   | |         +-|-|-----|---------------------+ |   | |           | | +---------------+             |     |   |     | | |         | | | |   | | | |   |   |   | \n" +
            "     | | |     | |     |     |     | | |   | |           | |     | |     |               |   | |           | |     |       |   |             |     |   |     | | |         | | | |   | | | |   |   |   | \n" +
            "     | | |     | |     |     |     | | |   | |           | |     | |     |               |   | |           | |     |       |   |             |     |   +-------|-|---------|-----|---|-|-|-|---+ +-|-+ | \n" +
            "     | | |     | |     |     |     | | |   | |           | |     | |     |               |   | |           | |     |       |   |             |     |         | | |         | | | |   | | | |     | | | | \n" +
            " +-------+     | |     |     |     | | +---|-|-------------|-----|-----------------------|---------------------+   |       |   |       +-----------|-------------|---------|-|-|-|-------|-----+ | | | | \n" +
            " |   | |       | |     |     |     | |     | |           | |     | |     |               |   | |           | | |   |       |   |       |     |     |         | | |         | | | |   | | | |   | | | | | \n" +
            " |   | | +-------|-----------+     | |     | |           | |     | |     |               |   | | +-----------|-|-----------|---|-------|-----------|---------|-|-|---------|-+ | |   +-|-|-|---|-|-+ +-+ \n" +
            " |   | | |     | |     |           | |     | |           | |     | |     |               |   | | |         | | |   |       |   |       |     |     |         | | |         |   | |     | | |   | |       \n" +
            " |   | | |     | |     |           | |     | |           +-------+ +---------------------|---|-|-|---------|------M------------+     +-|-----------------------|---------------|-|-----|-|-|--W--------+ \n" +
            " |   | | |     | |     |           | |     | |             |             |               |   | | |         | | |   |       |         | |     |     |         | | |         |   | |     | | |   | |     | \n" +
            " |   | +-----------------------------------+ |             |             |               |   | | |         | | +---|-------------------+     |     +-----------|-----------|-------------+ +---|-------+ \n" +
            " |   |   Q     | |     |           | |       |             |             |               |   | | |         | |     |       |         |       |               | | |         |   | |     |       | |       \n" +
            " |   |   |     | |     +-------------|-------|-------------|-------------+               |   | | |         | |     |       |     +---|-------|---------------|---|-------------|-|-------------------+   \n" +
            " |   |   |     | |                 | |       |             |                             |   | | |         | |     |       |     |   |       |               | | |         |   | |     |       | |   |   \n" +
            " |   +---+     | |                 | |       |             |                             |   | | |         | | +---|-----------------|-----------------------|---|---------|---|-+     |       | |   |   \n" +
            " |             | |                 | |       |             |                             |   | | |         | | |   |       |     |   |       |               | | |         |   |       |       | |   |   \n" +
            " |             | |                 +---------+             |                             |   | | |         | | +-----------|-----|---|-----+ +---------------|-------------+   |       | +---+ | |   |   \n" +
            " |             | |                   |                     |                             |   | | |         | |     |       |     |   |     |                 | | |             |       | |   | | |   |   \n" +
            " |             | +-------------------+                     |                           +-----|-|-----------|-|-------------|-----|---|-----+     +-----------|-|-|-----------------------|-----|-+ +-+   \n" +
            " |             |                                           |                           | |   | | |         | |     |       |     |   |           |           | | |             |       | |   | |   |     \n" +
            " |             |                                           |                           | | +-|---|---------+ |     |       | +-------|-----------+ +-----------------+         +-------|-|---+ +-+ |     \n" +
            " |             |                                           |                           | | | | | |           |     |       | |   |   |             |         | | |   |                 | |       | |     \n" +
            " |             | +------A----------------------------------|---------------------------------+ | |           +---------------|-------|---------------------+ | +-|---+                 +-|-----+ | |     \n" +
            " |             | |                                         |                           | | |   | |                 |       | |   |   |             |       | |   |                       |     | | |     \n" +
            " |             | |                                         |                           | | |   | |                 |       | +---+   +-------------+       +-+   +-----------+           |     +-+ |     \n" +
            " |             | |                                         |                           | | |   | |                 |       |                                                 |           |         |     \n" +
            " +-------------+ +-----------------------------------------+                           +-+ +---+ +-----------------+       +-------------------------------------------------+           +---------+     \n" +
            "                                                                                                                                                                                                         ";

    String inputTest = "     |          \n" +
            "     |  +--+    \n" +
            "     A  |  C    \n" +
            " F---|----E|--+ \n" +
            "     |  |  |  D \n" +
            "     +B-+  +--+ \n";
    private int rows, cols;
    private String string = "";
    char[][] matrix = null;

    public Nineteen() {
        partOne(inputTest);
    }

    private void partOne(String inputTest) {
        List<String> lines = new ArrayList<>();
        Arrays.asList(inputTest.split("\\n")).forEach(
                line -> {
                    lines.add(line);
                }
        );


        int currentRow = 0;
        int currentCol = 0;

        cols = lines.get(0).length();
        rows = lines.size();
        matrix = new char[rows][cols];
        for (int r = 0; r < rows; r++) {
            for (int c = 0; c < cols; c++) {
                char character = lines.get(r).charAt(c);
                if (r == 0 && character == '|') {
                    currentCol = c;
                    currentRow = r;
                }
                matrix[r][c] = character;
            }
        }

        boolean found = false;
        boolean goDown = true;
        boolean goRight = true;
        boolean goingVertically = true;
        String pattern = "[A-Za-z]";
        while (!found) {
            char selectedChar = matrix[currentRow][currentCol];
            if (selectedChar == '|') {
                if (goDown) {
                    currentRow += 1;
                    if (Pattern.matches(pattern, "" + matrix[currentRow][currentCol])) {
                        string += matrix[currentRow][currentCol];
                        currentRow += 1;
                    } else if (matrix[currentRow][currentCol] == '-') {
                        currentRow += 1;
                    }
                } else {
                    currentRow -= 1;
                    if (Pattern.matches(pattern, "" + matrix[currentRow][currentCol])) {
                        string += matrix[currentRow][currentCol];
                        currentRow -= 1;
                    } else if (matrix[currentRow][currentCol] == '-') {
                        currentRow -= 1;
                    }
                }
                goingVertically = true;
            } else if (selectedChar == '-') {
                if (goRight) {
                    currentCol += 1;
                    if (Pattern.matches(pattern, "" + matrix[currentRow][currentCol])) {
                        string += matrix[currentRow][currentCol];
                        currentCol += 1;
                    } else if (matrix[currentRow][currentCol] == '|') {
                        currentCol += 1;
                    }
                } else {
                    currentCol -= 1;
                    if (Pattern.matches(pattern, "" + matrix[currentRow][currentCol])) {
                        string += matrix[currentRow][currentCol];
                        currentCol -= 1;
                    } else if (matrix[currentRow][currentCol] == '|') {
                        currentCol -= 1;
                    }
                }
                goingVertically = false;
            } else if (selectedChar == '+') {
                goingVertically = !goingVertically;
                if (goingVertically) {
                    if (currentRow + 1 < rows &&
                            matrix[currentRow + 1][currentCol] != '-' &&
                            matrix[currentRow + 1][currentCol] != ' ') {
                        currentRow += 1;
                        goDown = true;
                    } else if (currentRow - 1 >= 0 &&
                            matrix[currentRow - 1][currentCol] != '-' &&
                            matrix[currentRow - 1][currentCol] != ' ') {
                        currentRow -= 1;
                        goDown = false;
                    }
                } else {
                    if (currentCol + 1 < cols &&
                            matrix[currentRow][currentCol + 1] != '|' &&
                            matrix[currentRow][currentCol + 1] != ' ') {
                        currentCol += 1;
                        goRight = true;
                    } else if (currentCol - 1 >= 0 &&
                            matrix[currentRow][currentCol - 1] != '|' &&
                            matrix[currentRow][currentCol - 1] != ' ') {
                        currentCol -= 1;
                        goRight = false;
                    }
                }
            } else {
                string += selectedChar;
                if (goingVertically) {
                    currentRow += goDown ? 1 : -1;
                } else {
                    currentCol += goRight ? 1 : -1;
                }
            }

//            System.out.println("Nineteen.partOne: " + string);
            printMatrix(matrix, rows, cols, currentRow, currentCol);
            if (string.contains("MOABE")) {
                try {
                    Thread.sleep(100);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                }
            }
        }

//        findNextValue(currentRow, currentCol, true, true, ' ');
        System.out.println("Nineteen.partOne: " + string);
    }

    private void findNextValue(int currentRow, int currentCol, boolean goDown, boolean goRight, char previousChar) {
//
//        boolean found = false;
//
//
//        while (!found) {
//            System.out.println("Nineteen.findNextValue");
//        }

        //printMatrix(matrix, rows, cols, currentRow, currentCol);
        System.out.println("string: " + string + " matrix = [" + matrix + "], currentRow = [" + currentRow + "], currentCol = [" + currentCol + "], goDown = [" + goDown + "], goRight = [" + goRight + "], previousChar = [" + previousChar + "]");
        char c = matrix[currentRow][currentCol];
        if (c == '|' && currentRow + (goDown ? +1 : -1) >= 0 && currentRow + (goDown ? +1 : -1) < rows) {
            if (matrix[currentRow + (goDown ? +1 : -1)][currentCol] == '-') {
                findNextValue(currentRow + (goDown ? +2 : -2), currentCol, goDown, goRight, c);
            } else {
                findNextValue(currentRow + (goDown ? +1 : -1), currentCol, goDown, goRight, c);
            }
        } else if (c == '-' && currentCol + (goRight ? +1 : -1) >= 0 && currentCol + (goRight ? +1 : -1) < cols) {
            if (matrix[currentRow][currentCol + (goRight ? +1 : -1)] == '|') {
                findNextValue(currentRow, currentCol + (goRight ? +2 : -2), goDown, goRight, c);
            } else {
                findNextValue(currentRow, currentCol + (goRight ? +1 : -1), goDown, goRight, c);
            }
        } else if (c == '+') {
            if (previousChar == '|') {
                if (currentCol + 1 < cols && matrix[currentRow][currentCol + 1] == '-') {
                    findNextValue(currentRow, currentCol + 1, goDown, true, c);
                } else if (currentCol - 1 >= 0 && matrix[currentRow][currentCol - 1] == '-') {
                    findNextValue(currentRow, currentCol - 1, goDown, false, c);
                } else {
                    // is a letter
                    if (currentCol + 1 < cols && matrix[currentRow][currentCol + 1] != ' ' && matrix[currentRow][currentCol + 1] != '-') {
                        string += matrix[currentRow][currentCol + 1];
                        findNextValue(currentRow, currentCol + 2, goDown, true, '-');
                    } else if (currentCol - 1 >= 0 && matrix[currentRow][currentCol - 1] != ' ' && matrix[currentRow][currentCol - 1] != '-') {
                        string += matrix[currentRow][currentCol - 1];
                        findNextValue(currentRow, currentCol - 2, goDown, false, '-');
                    }
                }
            } else if (previousChar == '-') {
                if (currentRow + 1 < rows && matrix[currentRow + 1][currentCol] == '|') {
                    findNextValue(currentRow + 1, currentCol, true, true, c);
                } else if (currentRow - 1 >= 0 && matrix[currentRow - 1][currentCol] == '|') {
                    findNextValue(currentRow - 1, currentCol, false, false, c);
                } else {
                    // is a letter
                    if (currentRow + 1 < rows && matrix[currentRow + 1][currentCol] != ' ' && matrix[currentRow + 1][currentCol] != '|') {
                        string += matrix[currentRow + 1][currentCol];
                        System.out.println("Nineteen.findNextValue: " + string);
                        findNextValue(currentRow + 2, currentCol, true, true, '|');
                    } else if (currentRow - 1 >= 0 && matrix[currentRow - 1][currentCol] != ' ' && matrix[currentRow - 1][currentCol] != '|') {
                        string += matrix[currentRow - 1][currentCol];
                        System.out.println("Nineteen.findNextValue: " + string);
                        findNextValue(currentRow - 2, currentCol, false, false, '|');
                    }
                }
            }
        } else {
            // is a letter
            string += matrix[currentRow][currentCol];
            System.out.println("Nineteen.findNextValue: " + string);
            if (currentCol + (goRight ? +1 : -1) >= 0 && currentCol + (goRight ? +1 : -1) < cols && previousChar == '-' && matrix[currentRow][currentCol + (goRight ? 1 : -1)] != ' ') {
                findNextValue(currentRow, currentCol + (goRight ? 1 : -1), goDown, goRight, previousChar);
            } else if (currentRow + (goDown ? +1 : -1) >= 0 && currentRow + (goDown ? +1 : -1) < rows && previousChar == '|' && matrix[currentRow + (goDown ? 1 : -1)][currentCol] != ' ') {
                findNextValue(currentRow + (goDown ? 1 : -1), currentCol, goDown, goRight, previousChar);
            }
        }
    }

    private void printMatrix(char[][] matrix, int rows, int cols, int currentRow, int currentCol) {
        System.out.println(String.format("\033[2J"));
        for (int r = currentRow - 5; r < currentRow + 5; r++) {
            for (int c = currentCol - 5; c < currentCol + 5; c++) {
                try {
                    System.out.print("" + (currentRow == r ? (currentCol == c ? "(" : " ") : (" ")) + matrix[r][c] + (currentRow == r ? (currentCol == c ? ")" : " ") : (" ")));
                } catch (IndexOutOfBoundsException e) {
                    System.out.print(" ");
                }
            }
            System.out.println(" ");
        }

        System.out.println("************* " + currentRow + " " + currentCol + " " + string);
        System.out.println(" ");
    }
}
